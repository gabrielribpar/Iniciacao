function [alfa_pulmonar,beta_pulmonar,k_pul,t_0_pul,gamma_final,gamma_cardiaca_final,gamma_pulmonar_final]=Pixel_Misto(gamma_1,t,N,alfa_max,alfa_min,beta_max,beta_min,k_max,k_min,t_0_max,t_0_min,t_slope_min,t_pico_min,m_min,n_min)
options = optimoptions(@lsqcurvefit,'FunctionTolerance',1.0000e-04,'MaxIterations',1000,'Display','off');
fs=50;
gamma_2=diff(gamma_1)*fs;
alfa_cardiaco=1+(t_pico_min)^2/(t_pico_min-t_slope_min)^2;
beta_cardiaco=((t_pico_min-t_slope_min)^2)/t_pico_min;
pol_1=polyfit(t(1:N-1),gamma_2,13);
pico_derivada=polyval(pol_1,t_slope_min);
derivada=(alfa_cardiaco-1-(t_slope_min/beta_cardiaco))*exp(-t_slope_min/beta_cardiaco)*(t_slope_min)^(alfa_cardiaco-2);
fixo=(gamma(alfa_cardiaco)*beta_cardiaco^(alfa_cardiaco));
derivada=derivada/fixo;
k=pico_derivada/derivada;
posicao=ceil(t_slope_min*fs)+10;
x1(1)=k;
F=@(x,xdata)x(1)*gampdf(xdata,alfa_cardiaco,beta_cardiaco);
lb=0;
ub=1;
[x] = lsqcurvefit(F,x1,t(1:posicao),gamma_1(1:posicao),lb,ub,options);
k_card=x(1);
gamma_cardiaca_otm = gamma_norm(t,alfa_cardiaco,beta_cardiaco,x(1),0);
gamma_pulmonar=gamma_1-gamma_cardiaca_otm;
x1(1)=alfa_cardiaco;
x1(2)=beta_cardiaco;
x1(3)=k_card;
x1(4)=t_slope_min;
F=@(x,xdata)x(3)*gampdf(xdata-x(4),x(1),x(2));
lb=[0,0,0,0];
ub=[1.1*alfa_max,1.1*beta_max,1.1*k_max,1.1*t_0_max];
[x] = lsqcurvefit(F,x1,t,gamma_pulmonar,lb,ub,options);
x1(1)=k_card;
x1(2)=x(1);
x1(3)=x(2);
x1(4)=x(3);
x1(5)=x(4);
x1(6)=alfa_cardiaco;
x1(7)=beta_cardiaco;
x1(8)=x(1);
x1(9)=x(2);
x1(10)=x(3);
x1(11)=1.5*t_0_min;
F=@(x,xdata)x(1)*gampdf(xdata,x(6),x(7))+x(4)*gampdf(xdata-x(5),x(2),x(3))+x(10)*gampdf(xdata-x(11),x(8),x(9));
lb=[0,0.95*alfa_min,0.95*beta_min,0.95*k_min,0.95*t_0_min,0.9*alfa_cardiaco,0.9*beta_cardiaco,0,0,0,t_0_min];
ub=[1,1.05*alfa_max,1.05*beta_max,1.05*k_max,1.05*t_0_max,1.05*alfa_cardiaco,1.05*beta_cardiaco,10,5,1,7*t_0_min];
x = lsqcurvefit(F,x1,t,gamma_1,lb,ub,options);
gamma_cardiaca_final=gamma_norm(t,alfa_cardiaco,beta_cardiaco,x(1),0);
gamma_pulmonar_final=gamma_norm(t,x(2),x(3),x(4),x(5));
alfa_pulmonar=x(2);
beta_pulmonar=x(3);
k_pul=x(4);
t_0_pul=x(5);
gamma_final=gamma_cardiaca_final+gamma_pulmonar_final;
end